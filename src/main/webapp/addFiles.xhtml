<?xml version="1.0" encoding="UTF-8"?>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/JSP_Servlet/XHtml.xhtml to edit this template
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <title>File Upload and Display</title>
        <h:outputStylesheet library="primefaces" name="bootstrap/bootstrap.css" />
        <style>
            .navbar {
                background-color: #f8f9fa;
                padding: 10px;
                margin-bottom: 20px;
            }
            .navbar-brand {
                font-size: 24px;
                font-weight: bold;
            }
            .container {
                margin-top: 20px;
            }
            .card {
                margin-bottom: 20px;
            }
            .card-header {
                background-color: #f8f9fa;
                font-weight: bold;
            }
            .card-body {
                padding: 20px;
            }
        </style>
    </h:head>
    <h:body>
        <ui:include src="/parts/nav.xhtml"></ui:include>
        <h:outputText class="text-danger m-5" value="#{files.errMsg}" />


        <div class="container">
            
                <h:form enctype="multipart/form-data" styleClass="">
                    <h:commandButton value="Upload" action="#{files.addFile()}" styleClass="btn btn-primary m-3" />
                    <h:inputFile value="#{files.fileContent}"  class="mb-3" />
                </h:form>      
          

            <div class="card">
                <div class="card-header">
                    File List
                </div>
                <div class="card-body">
                    <h2>Manage Files</h2>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>File Id</th>
                                <th>File Name</th>
                                <th>Upload Data</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <c:forEach var="file" items="#{files.filesForCurrentUser}">
                                <tr>
                                    <td><h:outputText value="#{file.id}" /></td>
                                    <td><h:outputText value="#{file.fileName}" /></td>
                                    <td><h:outputText value="#{file.upload_data}" /></td>
                                    <td><h:form>
                                            <input type="hidden" name="userId" value="#{file.id}" />
                                            <h:commandButton styleClass="btn btn-danger" value="Delete"
                                                             action="#{files.deleteFile(file.id)}"></h:commandButton>
                                        </h:form></td>
                                    
                                 
                                </tr>
                            </c:forEach>
                        </tbody>
                    </table>

                    <!-- Panel to display selected file content -->
                    <p:panel id="fileContentPanel">
                        <h:outputText value="#{files.selectedFileContent}" rendered="#{not empty files.selectedFileContent}" />
                    </p:panel>

                </div>
            </div>
        </div>

        <h:outputScript library="primefaces" name="jquery/jquery.js" target="head" />
        <h:outputScript library="primefaces" name="bootstrap/bootstrap.js" target="head" />
    </h:body>
</html>